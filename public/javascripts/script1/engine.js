var DEFAULT_REQUEST_VALUE="example.com";var ERR_TAG="error";var ERR_NO_RESULTS="ERR_NO_RESULTS";var ERR_NO_DOMAIN="ERR_NO_DOMAIN";var ERR_TOO_MANY_REQUEST="ERR_TOO_MANY_REQUEST";var RTYPE_IPV4=1;var RTYPE_IPV6=2;var RTYPE_URL=3;var RTYPE_URL_WWW=4;var RTYPE_ERROR=-1;var map;var mapOverview;var mapMarker;var domTxtRequest;var serverIP;var requests;var requestGroup;var tooManyRequestsRaised;var allFadedOut;var iFrame;window.addEvent("domready",function(){domTxtRequest=$("txtRequest");iFrame=new IFrame("iframe_neighbors");domTxtRequest.value=DEFAULT_REQUEST_VALUE;mapInit();domTxtRequest.addEvent("focus",function(){onFocusRequest(true)});domTxtRequest.addEvent("blur",function(){onFocusRequest(false)});$("searchForm").addEvent("submit",function(A){new Event(A).stop();onValidateRequest()});iFrame.addEvent("mouseover",function(){this.scrolling="yes"});iFrame.addEvent("mouseout",function(){this.scrolling="no"});$("linkTerms").addEvent("click",function(B){new Event(B).stop();var A=new Fx.Scroll(window);A.toTop();var A=new Fx.Scroll(window,{onComplete:function(){new MochaUI.Window({id:"windowTerms",title:"Terms of service",loadMethod:"xhr",contentURL:"terms.htm",resizable:false,minimizable:false,maximizable:false,draggable:false,collapsible:false,width:400,height:360})}}).toTop()});setTooltips();setLoadingMode(false);tooManyRequestsRaised=false;allFadedOut=true});function setTooltips(){setTooltip("ipInfo_siteNameTitle","Name of the site.");setTooltip("ipInfo_siteSummaryTitle","Quick description of the site content.");setTooltip("ipInfo_creationDateTitle","Date when the site has been <b>launched</b>. This is not the date of domain registration.");setTooltip("ipInfo_ipTitle","IP address that identifies the server that hosts the site.");setTooltip("ipInfo_ownerTitle","Name of the person/organization who owns the domain.");setTooltip("ipInfo_registrarTitle","The company where domain is registered.");setTooltip("ipInfo_dailyVisitorsTitle","Unique daily visitors of the site. This is an <b>estimation</b> that gives you an idea about daily traffic on the site.");setTooltip("ipInfo_googlePagerankTitle","Index (0 to 10) used by Google to value a website, mostly based on link popularity.");setTooltip("ipInfo_languageTitle","Language used in the site.");setTooltip("mainPageColorsTitle","List of colors ordered by frequency used in the main page of the site. </br>Palette is constructed finding most used colors in the snapshot, not parsing CSS (this way you <b>also find picture colors</b>). Hold on the color to get the hex code.");setTooltip("mainPageInfo_w3cValidTitle","Tells if the main page is valid according to standards that have been defined by the W3C.");setTooltip("mainPageInfo_charsetTitle","Set of characters used in the site.");setTooltip("mainPageInfo_rssFeedTitle","Web feed format used to publish frequently updated content. RSS feed is <b>mainly used in blogs</b>, news feeds or podcasts.");setTooltip("ipLocation_countryTitle","Country in which the server is located.");setTooltip("ipLocation_regionTitle","Region in which the server is located.");setTooltip("ipLocation_cityTitle","City in which the server is located.");setTooltip("ipInfo_latitudeTitle","Latitude of the city in which the server is located.");setTooltip("ipInfo_longitudeTitle","Longitude of the city in which the server is located.");setTooltip("h2_ip_info","Information about the domain and server that hosts the site.");setTooltip("h2_mainpage_info","Information about the main page of the site (the one you would reach by entering the site address in your browser.)");setTooltip("h2_location","Location of the physical machine that hosts the site.");setTooltip("h2_neighbors","Lists the other websites that are hosted on the same machine.")}function setTooltip(A,C,B){if(C==null){return }if(B==null){B="What is it?"}$(A).setStyle("cursor","default");$(A).store("tip:title",B);$(A).store("tip:text",C);myTip=new Tips($(A),{showDelay:500,hideDelay:100,fixed:true,offsets:{x:50,y:10}})}function onFocusRequest(A){if(A){if(domTxtRequest.value==DEFAULT_REQUEST_VALUE){domTxtRequest.value=""}else{fadeAllDivOut()}}else{if(domTxtRequest.value==""){domTxtRequest.value=DEFAULT_REQUEST_VALUE}}}function initPage(){$$(".alt").each(function(A){A.innerHTML="&nbsp;";setTooltip(A,"","")});$("imgPagerank").src="style/img/pr/pr.png";$("imgValid").src="style/img/valid_default.png";$("imgRss").src="style/img/mini_rss_none.png";$("mainPageInfo_imgThumbnail").src="style/img/snapshot_default.jpg";$("imgFlag").src="style/img/flags/default.gif";iFrame.src="";$("mainPageColorBoxContainer").empty();iFrame.empty()}function fadeAllDivOut(){if(allFadedOut){return }fadeDivOut("panel_info");fadeDivOut("panel_mainPageInfo");fadeDivOut("panel_location");fadeDivOut("panel_neighbors");fadeDivOut("panel_adsense")}function onValidateRequest(){tooManyRequestsRaised=false;fadeAllDivOut();domTxtRequest.blur();stopAjaxServices();txtRequest=domTxtRequest.value;var A=getDataType(txtRequest);if(A!=RTYPE_URL){shakeSearchBar()}else{setLoadingMode(true);initPage();setServerIP(txtRequest)}}function setServerIP(A){var B="core/getIP.php";new Request({url:B,method:"get",data:"domain="+A,onSuccess:onSuccessSetServerIP,autoCancel:true}).send()}function onSuccessSetServerIP(){if(this.response.xml==null){return }error=xmlGetError(this.response.xml);if(error!=null){setLoadingMode(false);if(error==ERR_NO_DOMAIN){shakeSearchBar()}return }var A=this.response.xml.getElementsByTagName("ip_lookup").item(0);serverIP=xmlGetChildValue(A,"ip");callAjaxServices();fadeDivIn("panel_adsense")}function stopAjaxServices(){if(requests!=null){requests.each(function(A){A.cancel();delete A});requests=null}}function callAjaxServices(){requests=[getServerInfoRequest(),getMainPageInfoRequest(),getSiteLocationRequest(),getIPNeighborsRequest()];requestGroup=new Group(requests[0],requests[1],requests[2],requests[3]);requestGroup.addEvent("onComplete",function(){setLoadingMode(false)});requests.each(function(A){A.send()})}function getDataType(B){var A=new RegExp("^(([0-9]+.){1,3})+[0-9]+$","i");var E=new RegExp("^(([0-9]|[A-F]){1,4}:){7}([0-9]|[A-F]){1,4}$","i");var D=new RegExp("^(http|https|ftp)://[a-zA-Z0-9-.]+.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?/?([a-zA-Z0-9-._?,'/\\+&%$#=~])*[^.,)(s]$","i");var C=new RegExp("^[a-zA-Z0-9-.]+.[a-zA-Z]{2,3}(:[a-zA-Z0-9]*)?/?([a-zA-Z0-9-._?,'/\\+&%$#=~])*[^.,)(s]$","i");if(B.match(A)){return RTYPE_IPV4}else{if(B.match(E)){return RTYPE_IPV6}else{if(B.match(C)){return RTYPE_URL}else{if(B.match(C)){return RTYPE_IPV4}else{return RTYPE_ERROR}}}}}function getServerInfoRequest(){return new Request({url:"core/getServerInfo.php",method:"get",data:"ip="+serverIP+"&domain="+domTxtRequest.value,onSuccess:onServerInfoReceived,autoCancel:true})}function onServerInfoReceived(){if(this.response.xml==null){return }var I=xmlGetError(this.response.xml);if(I!=null){return }var J=this.response.xml.getElementsByTagName("site_info").item(0);var G=xmlGetChildValue(J,"site_name");var A=xmlGetChildValue(J,"site_summary");var E=xmlGetChildValue(J,"creation_date");var C=xmlGetChildValue(J,"ip_address");var K=xmlGetChildValue(J,"owner_name");var B=xmlGetChildValue(J,"registrar");var H=xmlGetChildValue(J,"daily_visitors");var D=xmlGetChildValue(J,"google_pagerank");var F=xmlGetChildValue(J,"language");setInnerText("ipInfo_siteNameValue",G);setInnerText("ipInfo_siteSummaryValue",A,50);setInnerText("ipInfo_creationDateValue",E);setInnerText("ipInfo_ipValue",C);setInnerText("ipInfo_ownerValue",K);setInnerText("ipInfo_registrarValue",B);setInnerText("ipInfo_dailyVisitorsValue",H);setInnerText("ipInfo_googlePagerankValue",D);setInnerText("ipInfo_languageValue",F);$("imgPagerank").src="style/img/pr/pr"+D+".png";fadeDivIn("panel_info")}function getMainPageInfoRequest(){return new Request({url:"core/getMainPageInfo.php",method:"get",data:"domain="+domTxtRequest.value,onSuccess:onMainPageInfoReceived,autoCancel:true})}function onMainPageInfoReceived(){if(this.response.xml==null){return }var L=xmlGetError(this.response.xml);if(L!=null){return }var M=this.response.xml.getElementsByTagName("mainpage_info").item(0);var C=xmlGetChildValue(M,"thumbnail_path");var B=xmlGetChildValue(M,"valid");var E=xmlGetChildValue(M,"nb_errors");var D=xmlGetChildValue(M,"charset");var N=xmlGetChildValue(M,"rss_feed");$("imgValid").src="style/img/valid_"+B+".png";if(B=="false"){L=(E>1)?"errors":"error";setInnerText("mainPageInfo_w3cValidValue"," ("+E+" "+L+")")}setInnerText("mainPageInfo_charsetValue",D);if(N==""){setInnerText("mainPageInfo_rssFeedValue","none");$("imgRss").src="style/img/mini_rss_none.png"}else{$("imgRss").src="style/img/mini_rss.png";$("mainPageInfo_rssFeedValue").innerHTML='<a href="'+N+'" target="blank">Subscribe!</a>'}var I=M.getElementsByTagName("colors").item(0);var A=I.getElementsByTagName("color");for(var G=0;G<A.length;G++){var H=(xmlGetChildValue(A[G],"hex_value")).toUpperCase();var K=xmlGetChildValue(A[G],"frequency");var F=new Color("#"+H);frequencyPercent=(K*100).round();percentText="";if(frequencyPercent<=1){percentText="<1%"}else{percentText=frequencyPercent+"%"}var J=new Element("div",{"class":"colorBox",styles:{color:F.invert(),"background-color":F,"border-color":F.setBrightness(50),cursor:"pointer"},value:H,title:percentText,events:{mouseenter:function(){this.innerHTML=this.value},mouseleave:function(){this.innerHTML=this.title}}});J.innerHTML=percentText;$("mainPageColorBoxContainer").appendChild(J)}$("mainPageInfo_imgThumbnail").src=C;fadeDivIn("panel_mainPageInfo")}function getSiteLocationRequest(){return new Request({url:"core/getIPLocation.php",method:"get",data:"ip="+serverIP,onSuccess:onSiteLocationReceived,autoCancel:true})}function onSiteLocationReceived(){if(this.response.xml==null){return }var H=xmlGetError(this.response.xml);if(H!=null){return }var J=this.response.xml.getElementsByTagName("ip_location").item(0);var E=xmlGetChildValue(J,"country_code");var C=xmlGetChildValue(J,"country_name");var F=xmlGetChildValue(J,"region_code");var D=xmlGetChildValue(J,"region_name");var G=xmlGetChildValue(J,"city");var M=xmlGetChildValue(J,"postal_code");var I=xmlGetChildValue(J,"latitude");var B=xmlGetChildValue(J,"longitude");var L=xmlGetChildValue(J,"dma_code");var K=xmlGetChildValue(J,"area_code");var A=1;if(C==null){$("imgFlag").src="style/img/flags/default.gif"}else{setInnerText("ipLocation_countryValue",C);$("imgFlag").src="style/img/flags/"+E.toLowerCase()+".gif";A=3}if(D!=null){setInnerText("ipLocation_regionValue",D);A=5}if(G!=null){setInnerText("ipLocation_cityValue",G);A=7}if(I!=null&&B!=null){setInnerText("ipInfo_latitudeValue",I);setInnerText("ipInfo_longitudeValue",B);mapMarker.setLatLng(new google.maps.LatLng(I,B));map.setCenter(new google.maps.LatLng(I,B),A);mapMarker.show()}fadeDivIn("panel_location")}function getIPNeighborsRequest(){return new Request({url:"core/getIPNeighbors.php",method:"get",data:"ip="+serverIP,onSuccess:onIPNeighborsReceived,autoCancel:true})}function onIPNeighborsReceived(){if(this.response.xml==null){return }var B=xmlGetError(this.response.xml);if(B!=null){return }var A=this.response.xml.getElementsByTagName("ip_neighbors").item(0);iFrame.src="http://"+txtRequest;var D=A.getElementsByTagName("dom");var H=D.length;$("neighbors_left").innerHTML='<ul id="list_neighbors"></ul>';for(var C=0;C<H;C++){value=D[C].firstChild.data;$("list_neighbors").innerHTML+='\n<li id="'+C+'">'+value+"</li>"}var F=$$("#list_neighbors li");if(F.length>0){var G=F[0].getStyle("padding-left");var E=F[0].getStyle("color");F.each(function(I){I.setStyle("cursor","pointer");var J=new Fx.Morph(I,{duration:70,wait:false});I.addEvent("mouseenter",function(){J.start({"padding-left":"10px",color:"#F953B5"})});I.addEvent("mouseleave",function(){J.start({"padding-left":G,color:E})});I.addEvent("click",function(){iFrame.src="http://"+this.innerHTML})})}fadeDivIn("panel_neighbors")}function mapInit(){map=new google.maps.Map2(document.getElementById("map"));document.getElementById("map").style.backgroundColor="#FFFFFF";map.setCenter(new google.maps.LatLng(39,-22.5),1);map.enableContinuousZoom();map.addControl(new YSliderControl());mapOverview=new GOverviewMapControl(new GSize(100,84));map.addControl(mapOverview);baseIcon=new GIcon();baseIcon.shadow="style/img/map/shadow.png";baseIcon.iconSize=new GSize(50,42);baseIcon.shadowSize=new GSize(50,42);baseIcon.iconAnchor=new GPoint(19,31);baseIcon.image="style/img/map/marker.png";markerOptions={icon:baseIcon};mapMarker=new GMarker(new GLatLng(72.738003,-40.429687),markerOptions);map.addOverlay(mapMarker)}function xmlGetError(A){error=xmlGetChildValue(A,ERR_TAG);if(error==null||error==""){return null}if(error==ERR_TOO_MANY_REQUEST){if(!tooManyRequestsRaised){tooManyRequestsRaised=true;new MochaUI.Window({id:"windowTooManyRequests",title:"Oops!",loadMethod:"xhr",contentURL:"tooManyRequest.htm",resizable:false,minimizable:false,maximizable:false,draggable:false,headerStartColor:[250,215,236],headerStopColor:[252,169,218],collapsible:false,width:400,height:100})}}return error}function xmlGetChildValue(A,C){if(A==null){return""}var B=A.getElementsByTagName(C);if(B==null||B[0]==null||B[0].firstChild==null||B[0].firstChild.nodeValue==null){return""}else{return B[0].firstChild.nodeValue}}function setInnerText(A,B,C){if(C==null){C=30}displayedText="";if(B.length<=C){displayedText=B;setTooltip(A,"","")}else{displayedText=B.substr(0,C-3)+"...";setTooltip(A,B,"+")}$(A).innerHTML=displayedText}function shakeSearchBar(){var A=15;originalMargin=$("search_line").getStyle("margin-left").toInt();myFx=new Fx.Morph("search_line",{duration:50});myFx.start({"margin-left":[originalMargin,originalMargin+A]}).chain(function(){myFx.start({"margin-left":[originalMargin+A,originalMargin-A]})}).chain(function(){myFx.start({"margin-left":[originalMargin-A,originalMargin+A]})}).chain(function(){myFx.start({"margin-left":[originalMargin+A,originalMargin]})}).chain(function(){domTxtRequest.select()})}function fadeDivIn(A){new Fx.Morph(A,{duration:1000}).start({opacity:1});allFadedOut=false}function fadeDivOut(A){new Fx.Morph(A,{duration:500}).start({opacity:0.3})}function setLoadingMode(A){$("btValidateRequest").removeEvents();if(A){$("loading_icon").setStyle("display","block");$("btValidateRequest").addEvent("click",function(){setLoadingMode(false)});$("btValidateRequest").value="Cancel"}else{stopAjaxServices();$("btValidateRequest").addEvent("click",function(){onValidateRequest()});$("btValidateRequest").value="Go weasel it!";$("loading_icon").setStyle("display","none")}};